{
    "doc": {
        "description": "",
        "tags": []
    },
    "name": "bbn\\appui\\tasks",
    "namespace": true,
    "traits": [
        "bbn\\models\\tts\\references",
        "bbn\\models\\tts\\optional"
    ],
    "interfaces": [],
    "fileName": "\/home\/thomas\/domains\/apstapp.thomas.lan\/_appui\/vendor\/bbn\/bbn\/src\/bbn\/appui\/tasks.php",
    "startLine": 12,
    "endLine": 1225,
    "contentConstructor": {
        "file": "bbn\\appui\\tasks",
        "returns": null
    },
    "methods": {
        "__construct": {
            "name": "__construct",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(bbn\\db $db)\n  {\n    self::optional_init();\n    if ( $user = bbn\\user::get_instance() ){\n      $this->user = $user->get_name();\n      $this->id_user = $user->get_id();\n      $this->is_dev = $user->is_dev();\n      $this->mgr = new bbn\\user\\manager($user);\n      $this->_get_references();\n      \/\/die(var_dump(BBN_APP_PATH, $this->references));\n      if ( is_dir(\\bbn\\mvc::get_app_path()) && is_file(\\bbn\\mvc::get_app_path().'plugins\/appui-task\/reference.php') ){\n        $f = include(\\bbn\\mvc::get_app_path().'plugins\/appui-task\/reference.php');\n        if ( is_callable($f) ){\n          $this->template = $f;\n        }\n      }\n    }\n    $this->columns = array_keys($this->db->get_columns('bbn_tasks'));\n  }",
            "startLine": 47,
            "endLine": 65,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": {
                "name": "__construct",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\db",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function(bbn\\db $db)\n  {\n  }",
                "startLine": 27,
                "endLine": 29,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 1,
                "numberOfRequiredParameters": 1,
                "returns": null,
                "parent": false,
                "arguments": [
                    {
                        "name": "db",
                        "position": 0,
                        "type": "bbn\\db",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "db",
                    "position": 0,
                    "type": "bbn\\db",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "cat_correspondances": {
            "name": "cat_correspondances",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      $cats = self::get_options_tree('cats');\n      $res = [];\n      $opt->map(function ($a) use (&$res){\n        $res[] = [\n          'value' => $a['id'],\n          'text' => $a['text']\n        ];\n        $a['is_parent'] = !empty($a['items']);\n        if ( $a['is_parent'] ){\n          $a['expanded'] = true;\n        }\n        return $a;\n      }, $cats, 1);\n      \\bbn\\x::sort_by($res, 'text', 'ASC');\n      return $res;\n    }\n    return false;\n  }",
            "startLine": 67,
            "endLine": 86,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_tasks_options": {
            "name": "get_tasks_options",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      ($states = self::get_appui_options_ids('states')) &&\n      ($roles = self::get_appui_options_ids('roles')) &&\n      ($cats = self::cat_correspondances())\n    ){\n      return [\n        'states' => $states,\n        'roles' => $roles,\n        'cats' => $cats\n      ];\n    }\n  }",
            "startLine": 88,
            "endLine": 100,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "check": {
            "name": "check",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 102,
            "endLine": 104,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "check",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n      return false;\n    }\n    return true;\n  }",
                "startLine": 56,
                "endLine": 61,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "get_title": {
            "name": "get_title",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $simple = false)\n  {\n      return (!empty($simple) ? (_(\"Task\").\" \") : '').$title;\n    }\n    return '';\n  }",
            "startLine": 106,
            "endLine": 111,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "simple",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "categories": {
            "name": "categories",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 113,
            "endLine": 115,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "actions": {
            "name": "actions",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 117,
            "endLine": 119,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "states": {
            "name": "states",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 121,
            "endLine": 123,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "roles": {
            "name": "roles",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 125,
            "endLine": 127,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "id_cat": {
            "name": "id_cat",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($code)\n  {\n  }",
            "startLine": 129,
            "endLine": 131,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "code",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "id_action": {
            "name": "id_action",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($code)\n  {\n  }",
            "startLine": 133,
            "endLine": 135,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "code",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "id_state": {
            "name": "id_state",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($code)\n  {\n  }",
            "startLine": 137,
            "endLine": 139,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "code",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "id_role": {
            "name": "id_role",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($code)\n  {\n  }",
            "startLine": 141,
            "endLine": 143,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "code",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_mine": {
            "name": "get_mine",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($parent = NULL, $order = 'priority', $dir = 'ASC', $limit = 50, $start = 0)\n  {\n  }",
            "startLine": 145,
            "endLine": 147,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 5,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "parent",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "priority",
                    "default_name": ""
                },
                {
                    "name": "dir",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "ASC",
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 3,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 50,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 4,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "translate_log": {
            "name": "translate_log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $log)\n  {\n    $user = bbn\\user::get_instance();\n    if ( $opt && $user && isset($log['action'], $log['id_user']) ){\n      $type = explode('_', $opt->code($log['action']));\n      $action = $user->get_name($this->mgr->get_user($log['id_user'])).' '.$opt->text($log['action']);\n\n      $log['value'] = empty($log['value']) ? [] : json_decode($log['value']);\n      if ( !empty($log['value']) ){\n        $values = [];\n        switch ( $type[0] ){\n          case 'deadline':\n            foreach ( $log['value'] as $v ){\n              array_push($values, bbn\\date::format($v, 's'));\n            }\n            break;\n          case 'title':\n            $values = $log['value'];\n            break;\n          case 'comment':\n            array_push($values, bbn\\str::cut($this->db->get_one(\"\n            SELECT content\n            FROM bbn_notes_versions\n            WHERE id_note = ?\n            ORDER BY version DESC\n            LIMIT 1\",\n              $log['value'][0]), 80));\n            break;\n          case 'role':\n            if ( ($user = bbn\\user::get_instance()) && isset($log['value'][0], $log['value'][1]) ){\n              $values[0] = $user->get_name($this->mgr->get_user($log['value'][0]));\n              $values[1] = $opt->text($log['value'][1]);\n            }\n            break;\n          case 'priority':\n            $values = $log['value'];\n            break;\n          case 'price':\n          case 'approved':\n            foreach ( $log['value'] as $i => $v ){\n              $values[] = number_format((float)$v, 2, ',', '.');\n            }\n            break;\n          default:\n            foreach ( $log['value'] as $v ){\n              array_push($values, $opt->text($v));\n            }\n        }\n        if ( !empty($values) ){\n          foreach ( $values as $i => $v ){\n            $values[$i] = '<strong>'.$v.'<\/strong>';\n          }\n          array_unshift($values, $action);\n          return \\sprintf(...$values);\n        }\n      }\n      return $action;\n    }\n    return false;\n  }",
            "startLine": 149,
            "endLine": 208,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "log",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_log": {
            "name": "get_log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $res = [];\n    foreach ( $logs as $log ){\n      array_push($res, [\n        'action' => $this->translate_log($log),\n        'id_user' => $log['id_user'],\n        'chrono' => $log['chrono']\n      ]);\n    }\n    return $res;\n  }",
            "startLine": 210,
            "endLine": 221,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_all_logs": {
            "name": "get_all_logs",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($limit = 100, $start = 0)\n  {\n    $res = [];\n    foreach ( $logs as $log ){\n      array_push($res, [\n        'action' => $this->translate_log($log),\n        'id_user' => $log['id_user'],\n        'chrono' => $log['chrono']\n      ]);\n    }\n    return $res;\n  }",
            "startLine": 223,
            "endLine": 234,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "limit",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 100,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "get_approved_log": {
            "name": "get_approved_log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      $this->exists($id) &&\n      ($action = $this->id_action('price_approved'))\n    ){\n      return $this->db->rselect('bbn_tasks_logs', [], [\n        'id_task' => $id,\n        'action' => $action\n      ], ['chrono' => 'DESC']) ?: new \\stdClass();\n    }\n    return new \\stdClass();\n  }",
            "startLine": 236,
            "endLine": 247,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_price_log": {
            "name": "get_price_log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      $this->exists($id) &&\n      ($action_ins = $this->id_action('price_insert')) &&\n      ($action_upd = $this->id_action('price_update'))\n    ){\n      return $this->db->rselect([\n        'table' => 'bbn_tasks_logs',\n        'where' => [\n          'logic' => 'AND',\n          'conditions' => [[\n            'field' => 'id_task',\n            'operation' => '=',\n            'value' => $id\n          ], [\n            'logic' => 'OR',\n            'conditions' => [[\n              'field' => 'action',\n              'operatort' => '=',\n              'value' => $action_ins\n            ], [\n              'field' => 'action',\n              'operatort' => '=',\n              'value' => $action_upd\n            ]]\n          ]]\n        ],\n        'order' => [[\n          'field' => 'chrono',\n          'dir' => 'DESC'\n        ]]\n      ]) ?: new \\stdClass();\n    }\n  }",
            "startLine": 249,
            "endLine": 282,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_list": {
            "name": "get_list",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($parent = NULL, $status = 'opened|ongoing|holding', $id_user = false, $order = 'priority', $dir = 'ASC', $limit = 1000, $start = 0)\n  {\n      'id' => 'bbn_tasks.id',\n      'last' => 'last',\n      'first' => 'first',\n      'duration' => 'duration',\n      'num_children' => 'num_children',\n      'title' => 'title',\n      'num_notes' => 'num_notes',\n      'role' => 'role',\n      'state' => 'state',\n      'priority' => 'priority'\n    ];\n    if ( !isset($orders_ok[$order]) ||\n      !bbn\\str::is_integer($limit, $start) ||\n      (!\\is_null($parent) && !bbn\\str::is_integer($parent))\n    ){\n      return false;\n    }\n    $dir = strtolower($dir) === 'asc' ? 'ASC' : 'DESC';\n    if ( !$id_user ){\n      $id_user = $this->id_user;\n    }\n    $where = [];\n    if ( !empty($status) ){\n      $statuses = [];\n      $tmp = explode(\"|\", $status);\n      foreach ( $tmp as $s ){\n        if ( $t = $this->id_state($s) ){\n          array_push($statuses, $t);\n          array_push($where, \"`bbn_tasks`.`state` = $t\");\n        }\n      }\n    }\n    $where = \\count($where) ? implode( \" OR \", $where) : '';\n    $sql = \"\n    SELECT `role`, bbn_tasks.*,\n    FROM_UNIXTIME(MIN(bbn_tasks_logs.chrono)) AS `first`,\n    FROM_UNIXTIME(MAX(bbn_tasks_logs.chrono)) AS `last`,\n    {$this->references_select}\n    COUNT(children.id) AS num_children,\n    COUNT(DISTINCT bbn_tasks_notes.id_note) AS num_notes,\n    MAX(bbn_tasks_logs.chrono) - MIN(bbn_tasks_logs.chrono) AS duration\n    FROM bbn_tasks_roles\n      JOIN bbn_tasks\n        ON bbn_tasks_roles.id_task = bbn_tasks.id\n      JOIN bbn_tasks_logs\n        ON bbn_tasks_logs.id_task = bbn_tasks_roles.id_task\n      LEFT JOIN bbn_tasks_notes\n        ON bbn_tasks_notes.id_task = bbn_tasks_roles.id_task\n      LEFT JOIN bbn_tasks AS children\n        ON bbn_tasks_roles.id_task = children.id_parent\n      {$this->references_join}\n    WHERE bbn_tasks_roles.id_user = ?\".\n      (empty($where) ? '' : \" AND ($where)\").\"\n    AND bbn_tasks.active = 1\n    AND bbn_tasks.id_alias IS NULL\n    AND bbn_tasks.id_parent \".( \\is_null($parent) ? \"IS NULL\" : \"= $parent\" ).\"\n    GROUP BY bbn_tasks_roles.id_task\n    LIMIT $start, $limit\";\n\n    $opt = bbn\\appui\\options::get_instance();\n    $res = $this->db->get_rows($sql, $id_user);\n    foreach ( $res as $i => $r ){\n      $res[$i]['hasChildren'] = $r['num_children'] ? true : false;\n    }\n    \/*\n    foreach ( $res as $i => $r ){\n      $res[$i]['details'] = $this->info($r['id']);\n    }\n    *\/\n    bbn\\x::sort_by($res, $order, $dir);\n    return $res;\n  }",
            "startLine": 284,
            "endLine": 357,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 7,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "parent",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "status",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "opened|ongoing|holding",
                    "default_name": ""
                },
                {
                    "name": "id_user",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 3,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "priority",
                    "default_name": ""
                },
                {
                    "name": "dir",
                    "position": 4,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "ASC",
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 5,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 1000,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 6,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "get_slist": {
            "name": "get_slist",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($search, $order = 'last', $dir = 'DESC', $limit = 1000, $start = 0)\n  {\n      'id' => 'bbn_tasks.id',\n      'last' => 'last',\n      'first' => 'first',\n      'duration' => 'duration',\n      'num_children' => 'num_children',\n      'title' => 'title',\n      'num_notes' => 'num_notes',\n      'role' => 'role',\n      'state' => 'state',\n      'priority' => 'priority'\n    ];\n    if ( !isset($orders_ok[$order]) || !bbn\\str::is_integer($limit, $start) ){\n      return false;\n    }\n    $dir = strtolower($dir) === 'asc' ? 'ASC' : 'DESC';\n    $sql = \"\n    SELECT bbn_tasks.*, role,\n    FROM_UNIXTIME(MAX(bbn_tasks_logs.chrono)) AS `last_action`,\n    {$this->references_select}\n    COUNT(children.id) AS num_children,\n    COUNT(DISTINCT bbn_tasks_notes.id_note) AS num_notes,\n    IF(bbn_tasks.`state`=\".$this->id_state('closed').\", MAX(bbn_tasks_logs.chrono), UNIX_TIMESTAMP()) - MIN(bbn_tasks_logs.chrono) AS duration\n    FROM bbn_tasks\n      JOIN bbn_tasks_logs\n        ON bbn_tasks_logs.id_task = bbn_tasks.id\n      LEFT JOIN bbn_tasks_notes\n        ON bbn_tasks_notes.id_task = bbn_tasks.id\n      LEFT JOIN bbn_tasks_roles\n        ON bbn_tasks_roles.id_task = bbn_tasks.id\n        AND bbn_tasks_roles.id_user = {$this->id_user}\n      LEFT JOIN bbn_notes_versions\n        ON bbn_notes_versions.id_note = bbn_tasks_notes.id_note\n      LEFT JOIN bbn_tasks AS children\n        ON children.id = bbn_tasks.id\n      {$this->references_join}\n    WHERE (bbn_tasks.title LIKE ?\n    OR bbn_notes_versions.content LIKE ?)\n    AND bbn_tasks.active = 1\n    GROUP BY bbn_tasks.id\n    LIMIT $start, $limit\";\n\n    $opt = bbn\\appui\\options::get_instance();\n    $res = $this->db->get_rows($sql, \"%$search%\");\n    \/*\n    foreach ( $res as $i => $r ){\n      $res[$i]['type'] = $opt->itext($r['type']);\n      $res[$i]['state'] = $opt->itext($r['state']);\n      $res[$i]['role'] = $opt->itext($r['role']);\n      $res[$i]['hasChildren'] = $r['num_children'] ? true : false;\n    }\n    foreach ( $res as $i => $r ){\n      $res[$i]['details'] = $this->info($r['id']);\n    }\n    *\/\n    bbn\\x::sort_by($res, $order, $dir);\n    return [\n      'data' => $res,\n      'total' => \\count($res)\n    ];\n  }",
            "startLine": 359,
            "endLine": 420,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 5,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "search",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "order",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "last",
                    "default_name": ""
                },
                {
                    "name": "dir",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": "DESC",
                    "default_name": ""
                },
                {
                    "name": "limit",
                    "position": 3,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 1000,
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 4,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                }
            ]
        },
        "get_tree": {
            "name": "get_tree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id = NULL, $closed = false)\n  {\n    $res = [];\n    $all = $this->get_list($id ?: null, $statuses, 5000);\n    foreach ( $all as $a ){\n      array_push($res, [\n        'id' => $a['id'],\n        'text' => $a['title'].' ('.bbn\\date::format($a['first']).'-'.bbn\\date::format($a['last']).')',\n        'is_parent' => $a['num_children'] ? true : false\n      ]);\n    }\n    return $res;\n  }",
            "startLine": 422,
            "endLine": 434,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                },
                {
                    "name": "closed",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "add_link": {
            "name": "add_link",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 440,
            "endLine": 442,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "info": {
            "name": "info",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id, $with_comments = false)\n  {\n      $info['first'] = $this->db->select_one('bbn_tasks_logs', 'chrono', [\n        'id_task' => $id,\n        'action' => $this->id_action('insert')\n      ], ['chrono' => 'ASC']);\n      $info['last'] = $this->db->select_one('bbn_tasks_logs', 'chrono', [\n        'id_task' => $id,\n      ], ['chrono' => 'DESC']);\n      $info['roles'] = $this->info_roles($id);\n      $info['notes'] = $with_comments ? $this->get_comments($id) : $this->get_comments_ids($id);\n      $info['children'] = $this->db->rselect_all('bbn_tasks', [], ['id_parent' => $id, 'active' => 1]);\n      $info['aliases'] = $this->db->rselect_all('bbn_tasks', ['id', 'title'], ['id_alias' => $id, 'active' => 1]);\n      $info['num_children'] = \\count($info['children']);\n      if ( $info['num_children'] ){\n        $info['has_children'] = 1;\n        foreach ( $info['children'] as $i => $c ){\n          $info['children'][$i]['num_children'] = $this->db->count('bbn_tasks', ['id_parent' => $c['id'], 'active' => 1]);\n        }\n      }\n      else{\n        $info['has_children'] = false;\n      }\n      $info['reference'] = false;\n      if ( $this->references ){\n        foreach ( $this->references as $table => $ref ){\n          foreach ( $ref['refs'] as $j => $r ){\n            if ( $id_ref = $this->db->select_one($table, $j, [$ref['column'] => $id]) ){\n              $info['reference'] = $this->template === false ? $id_ref : \\call_user_func($this->template, $this->db, $id_ref, $table);\n              break;\n            }\n          }\n          if ( $info['reference'] ){\n            break;\n          }\n        }\n      }\n      return $info;\n    }\n  }",
            "startLine": 444,
            "endLine": 483,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "with_comments",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "get_state": {
            "name": "get_state",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      return $this->db->select_one('bbn_tasks', 'state', ['id' => $id]);\n    }\n  }",
            "startLine": 484,
            "endLine": 488,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_comments_ids": {
            "name": "get_comments_ids",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      SELECT bbn_tasks_notes.id_note\n      FROM bbn_tasks_notes\n        JOIN bbn_notes_versions\n          ON bbn_notes_versions.id_note = bbn_tasks_notes.id_note\n      WHERE id_task = ?\n      GROUP BY bbn_tasks_notes.id_note\n      ORDER BY MAX(bbn_notes_versions.creation)\",\n      hex2bin($id_task));\n  }",
            "startLine": 490,
            "endLine": 500,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "search": {
            "name": "search",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $where = [], $sort = [], $start = 0, $num = 25)\n  {\n    $fields = [\n      'ids' => [\n        'id_parent' => 'bbn_tasks.id_parent',\n        'id_user' => 'bbn_tasks.id_user',\n        'state' => 'bbn_tasks.state',\n        'role' => 'my_role.role',\n        'type' => 'bbn_tasks.type'\n      ],\n      'nums' => [\n        'num_notes' => 'num_notes',\n        'duration' => 'duration',\n        'priority' => 'bbn_tasks.priority'\n      ],\n      'dates' => [\n        'deadline' => 'bbn_tasks.deadline',\n        'creation_date' => 'creation_date',\n        'last_action' => 'last_action'\n      ],\n      'texts' => [\n        'title' => 'bbn_tasks.title',\n        'text' => 'bbn_notes_versions.content'\n      ],\n      'users' => [\n        'my_user' => '',\n        'my_group' => ''\n      ],\n      'refs' => [\n        'reference' => 'reference'\n      ]\n    ];\n    $query = '';\n    $join = '';\n    $having = '';\n    $order = '';\n    $args1 = [];\n    $args2 = [];\n    foreach ( $where as $i => $w ){\n      if ( isset($fields['ids'][$w[0]]) ){\n        \/\/ For id_parent, no other search for now\n        if ( $w[0] === 'id_parent' ){\n          $query = \"AND \".$fields['ids'][$w[0]].\" = ? \";\n          $args = [$w[2]];\n          break;\n        }\n        else if ( \\is_array($w[2]) ){\n          $query .= \"AND ( \";\n          foreach ( $w[2] as $j => $v ){\n            if ( $j ){\n              $query .= \" OR \";\n            }\n            $query .= $fields['ids'][$w[0]].\" = ? \";\n            array_push($args1, $v);\n          }\n          $query .= \") \";\n        }\n        else{\n          $query .= \" AND \".$fields['ids'][$w[0]].\" $w[1] ? \";\n          array_push($args1, $w[2]);\n        }\n      }\n      else if ( isset($fields['dates'][$w[0]]) ){\n        if ( strpos($w[1], 'IS ') === 0 ){\n          $query .= \" AND \".$fields['dates'][$w[0]].\" $w[1] \";\n        }\n        else if ( bbn\\date::validateSQL($w[2]) ){\n          if ( $w[0] !== 'deadline' ){\n            $having .= \" AND DATE(\".$fields['dates'][$w[0]].\") $w[1] ? \";\n            array_push($args2, $w[2]);\n          }\n          else{\n            $query .= \" AND DATE(\".$fields['dates'][$w[0]].\") $w[1] ? \";\n            array_push($args1, $w[2]);\n          }\n        }\n      }\n      else if ( isset($fields['nums'][$w[0]]) ){\n        if ( \\is_int($w[2]) ){\n          $query .= \" AND \".$fields['nums'][$w[0]].\" $w[1] ? \";\n          array_push($args1, $w[2]);\n        }\n      }\n      else if ( isset($fields['texts'][$w[0]]) ){\n        if ( !empty($w[2]) ){\n          if ( $w[0] === 'title' ){\n            $query .= \" AND bbn_tasks.title LIKE ? \";\n            array_push($args1, \"%$w[2]%\");\n          }\n          else if ( $w[0] === 'text' ){\n            $query .= \" AND (bbn_tasks.title LIKE ? OR bbn_notes_versions.content LIKE ?) \";\n            array_push($args1, \"%$w[2]%\", \"%$w[2]%\");\n            $join .= \"\n        LEFT JOIN bbn_tasks_notes\n          ON bbn_tasks_notes.id_task = bbn_tasks.id\";\n          }\n        }\n      }\n      else if ( isset($fields['users'][$w[0]]) ){\n        if ( !empty($w[2]) ){\n          if ( $w[0] === 'my_user' ){\n            $query .= \" AND user_role.id_user = ?\";\n            array_push($args1, hex2bin($w[2]));\n            $join .= \"\n        JOIN bbn_tasks_roles AS user_role\n          ON user_role.id_task = bbn_tasks.id\";\n          }\n          else if ( ($w[0] === 'my_group') && ($usr = bbn\\user::get_instance()) ){\n            $usr_table = $usr->get_tables()['users'];\n            $usr_fields = $usr->get_fields('users');\n            $query .= \" AND `\".$usr_table.\"`.`\".$usr_fields['id_group'].\"` = ? \";\n            array_push($args1, hex2bin($w[2]));\n            $join .= \"\n        JOIN bbn_tasks_roles AS group_role\n          ON group_role.id_task = bbn_tasks.id\n        JOIN `\".$usr_table.\"`\n          ON bbn_tasks_roles.id_user = `\".$usr_table.\"`.`\".$usr_fields['id'].\"`\";\n          }\n        }\n      }\n      else if ( isset($fields['refs'][$w[0]]) ){\n        if ( \\is_int($w[2]) ){\n          $having .= \" AND \".$fields['refs'][$w[0]].\" $w[1] ? \";\n          array_push($args1, $w[2]);\n        }\n      }\n    }\n    foreach ( $fields as $i => $f ){\n      foreach ( $f as $n => $g ){\n        if ( isset($sort[$n]) ){\n          $order = '`'.$n.'`'.( strtolower($sort[$n]) === 'desc' ? ' DESC' : ' ASC').', ';\n        }\n      }\n    }\n    if ( !empty($order) ){\n      $order = \"ORDER BY \".substr($order, 0, -2);\n    }\n    $args0 = [\n      hex2bin($this->id_state('closed')),\n      hex2bin($this->id_user)\n    ];\n    $sql = \"\n      SELECT my_role.role, bbn_tasks.*,\n      FROM_UNIXTIME(MAX(bbn_tasks_logs.chrono)) AS `last_action`,\n      COUNT(children.id) AS num_children,\n      COUNT(DISTINCT bbn_tasks_notes.id_note) AS num_notes,\n      {$this->references_select}\n      IF(bbn_tasks.`state` = ?, MAX(bbn_tasks_logs.chrono), UNIX_TIMESTAMP()) - MIN(bbn_tasks_logs.chrono) AS duration\n      FROM bbn_tasks\n        LEFT JOIN bbn_tasks_roles AS my_role\n          ON my_role.id_task = bbn_tasks.id\n          AND my_role.id_user = ?\n        LEFT JOIN bbn_tasks_roles\n          ON bbn_tasks_roles.id_task = bbn_tasks.id\n        JOIN bbn_tasks_logs\n          ON bbn_tasks_logs.id_task = bbn_tasks_roles.id_task\n        LEFT JOIN bbn_tasks_notes\n          ON bbn_tasks_notes.id_task = bbn_tasks.id\n        LEFT JOIN bbn_tasks AS children\n          ON bbn_tasks_roles.id_task = children.id_parent\n        $join\n        {$this->references_join}\n      WHERE bbn_tasks.active = 1\n      $query\n      GROUP BY bbn_tasks.id\n      HAVING 1\n      $having\n      $order\";\n    \/\/die(bbn\\x::dump($sql));\n    if ( !isset($args) ){\n      $args = array_merge($args0, $args1, $args2);\n    }\n    $data = $this->db->get_rows($sql.\" LIMIT $start, $num\", $args);\n    \/** @var bbn\\user $user *\/\n    $user = bbn\\user::get_instance();\n    foreach ( $data as $i => $d ){\n      if ( $this->template ){\n        if ( $d['reference'] ){\n          \/** @todo How do I get the t1able with the way I made the request??! *\/\n          $data[$i]['reference'] = \\call_user_func($this->template, $this->db, $d['reference'], '');\n        }\n      }\n    }\n    return [\n      'data' => $data,\n      'total' => $this->db->get_one(\"SELECT COUNT(*) FROM ($sql) AS t\", $args),\n      'start' => $start,\n      'limit' => $num\n    ];\n  }",
            "startLine": 518,
            "endLine": 707,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 4,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "where",
                    "position": 0,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                },
                {
                    "name": "sort",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                },
                {
                    "name": "start",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 0,
                    "default_name": ""
                },
                {
                    "name": "num",
                    "position": 3,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": 25,
                    "default_name": ""
                }
            ]
        },
        "search_in_task": {
            "name": "search_in_task",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($st)\n  {\n  }",
            "startLine": 709,
            "endLine": 711,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "st",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "full_info": {
            "name": "full_info",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n  }",
            "startLine": 713,
            "endLine": 715,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "info_roles": {
            "name": "info_roles",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    if (\n      ($opt = bbn\\appui\\options::get_instance()) &&\n      ($roles = self::get_appui_options('roles'))\n    ){\n      $all = $this->db->rselect_all(\n        'bbn_tasks_roles',\n        [],\n        ['id_task' => $id],\n        ['role' => 'ASC']);\n      $n = false;\n      foreach ( $all as $a ){\n        $code = bbn\\x::get_field($roles, ['id' => $a['role']], 'code');\n        if ( $n !== $code ){\n          $n = $code;\n          $r[$n] = [];\n        }\n        array_push($r[$n], $a['id_user']);\n      }\n    }\n    return $r;\n  }",
            "startLine": 717,
            "endLine": 739,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "has_role": {
            "name": "has_role",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $id_user)\n  {\n      $r = $this->db->select_one('bbn_tasks_roles', 'role', ['id_task' => $id_task, 'id_user' => $id_user]);\n      if ( $r ){\n        return $opt->code($r);\n      }\n    }\n    return false;\n  }",
            "startLine": 741,
            "endLine": 749,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_user",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_comments": {
            "name": "get_comments",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      $note = new \\bbn\\appui\\notes($this->db);\n      $ids = $this->get_comments_ids($id_task);\n      $r = [];\n      foreach ( $ids as $id_note ){\n        array_push($r, $note->get($id_note));\n      }\n      return $r;\n    }\n    return false;\n  }",
            "startLine": 751,
            "endLine": 762,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_comment": {
            "name": "get_comment",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $id_note)\n  {\n      $note = new \\bbn\\appui\\notes($this->db);\n      return $note->get($id_note);\n    }\n    return false;\n  }",
            "startLine": 764,
            "endLine": 770,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_note",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_users": {
            "name": "get_users",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n  }",
            "startLine": 772,
            "endLine": 774,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_deciders": {
            "name": "get_deciders",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      $this->exists($id_task) &&\n      ($role = $this->id_role('deciders'))\n    ){\n      return $this->db->get_column_values('bbn_tasks_roles', 'id_user', [\n        'id_task' => $id_task,\n        'role' => $role\n      ]);\n    }\n    return false;\n  }",
            "startLine": 776,
            "endLine": 787,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "comment": {
            "name": "comment",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, array $cfg)\n  {\n      $note = new \\bbn\\appui\\notes($this->db);\n      $r = $note->insert(\n        (empty($cfg['title']) ? '' : $cfg['title']),\n        (empty($cfg['text']) ? '' : $cfg['text']),\n        \\bbn\\appui\\notes::get_appui_option_id('tasks', 'types')\n      );\n      if ( $r ){\n        $this->db->insert('bbn_tasks_notes', [\n          'id_note' => $r,\n          'id_task' => $id_task\n        ]);\n        if ( !empty($cfg['files']) ){\n          $filename = '';\n          $extension = '';\n          $length = 0;\n          foreach ( $cfg['files'] as $f ){\n            $ext = \\bbn\\str::file_ext($f, true);\n            if (\n              (\\strlen($ext[0]) < $length) ||\n              ($ext[1] !== $extension) ||\n              (strpos($ext[0], $filename) !== 0) ||\n              !preg_match('\/_h[\\d]+\/i', substr($ext[0], $length))\n            ){\n              $filename = $ext[0];\n              $extension = $ext[1];\n              $length = \\strlen($filename);\n              $note->add_media($r, $f);\n            }\n          }\n        }\n        if ( !empty($cfg['links']) ){\n          foreach ( $cfg['links'] as $f ){\n            $ext = \\bbn\\str::file_ext($f['image'], true);\n            if ( !preg_match('\/_h[\\d]+\/i', substr($ext[0], 0)) ){\n              $note->add_media(\n                $r,\n                $f['image'],\n                json_encode(['url' => $f['url'], 'description' => $f['desc']]),\n                $f['title'],\n                'link'\n              );\n            }\n          }\n        }\n        $this->add_log($id_task, 'comment_insert', [$this->id_user, empty($cfg['title']) ? $cfg['text'] : $cfg['title']]);\n      }\n      return $r;\n    }\n    return false;\n  }",
            "startLine": 789,
            "endLine": 840,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "cfg",
                    "position": 1,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "add_log": {
            "name": "add_log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $action, array $value = [])\n  {\n      $data = [\n        'id_task' => $id_task,\n        'id_user' => $this->id_user,\n        'action' => \\bbn\\str::is_uid($action) ? $action : $this->id_action($action),\n        'value' => empty($value) ? '' : json_encode($value),\n        'chrono' => empty($this->date) ? microtime(true) : number_format((float)strtotime($this->date), 4, '.', '')\n      ];\n      $this->notify($data);\n      return $this->db->insert('bbn_tasks_logs', $data);\n    }\n    return false;\n  }",
            "startLine": 842,
            "endLine": 855,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "action",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "value",
                    "position": 2,
                    "type": "array",
                    "required": false,
                    "has_default": true,
                    "default": [],
                    "default_name": ""
                }
            ]
        },
        "notify": {
            "name": "notify",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $data)\n  {\n      $text = $this->translate_log($data);\n      $users = array_filter($this->get_users($data['id_task']), function($a) use($data){\n        return $a !== $data['id_user'];\n      });\n      $notif = new bbn\\appui\\notification($this->db);\n      return $notif->insert($title, $text, $users);\n    }\n    return false;\n  }",
            "startLine": 857,
            "endLine": 867,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "data",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "exists": {
            "name": "exists",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n  }",
            "startLine": 869,
            "endLine": 871,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "add_role": {
            "name": "add_role",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $role, $id_user = NULL)\n  {\n      if ( !bbn\\str::is_uid($role) ){\n        \/*if ( substr($role, -1) !== 's' ){\n          $role .= 's';\n        }*\/\n        $role = $this->id_role($role);\n      }\n      if ( bbn\\str::is_uid($role) && ($id_user || $this->id_user) ){\n        if ( $this->db->insert('bbn_tasks_roles', [\n          'id_task' => $id_task,\n          'id_user' => $id_user ?: $this->id_user,\n          'role' => $role\n        ]) ){\n          $this->add_log($id_task, 'role_insert', [$id_user ?: $this->id_user, $role]);\n          return 1;\n        }\n      }\n    }\n    return 0;\n  }",
            "startLine": 873,
            "endLine": 893,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "role",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_user",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "remove_role": {
            "name": "remove_role",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $id_user = NULL)\n  {\n      $role = $this->db->select_one('bbn_tasks_roles', 'role', [\n        'id_task' => $id_task,\n        'id_user' => $id_user ?: $this->id_user\n      ]);\n      if ( $this->db->delete('bbn_tasks_roles', [\n        'id_task' => $id_task,\n        'id_user' => $id_user ?: $this->id_user\n      ]) ){\n        $this->add_log($id_task, 'role_delete', [$id_user ?: $this->id_user, $role]);\n        return 1;\n      }\n    }\n    return 0;\n  }",
            "startLine": 895,
            "endLine": 910,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_user",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": null,
                    "default_name": ""
                }
            ]
        },
        "set_date": {
            "name": "set_date",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($date)\n  {\n    return $this;\n  }",
            "startLine": 912,
            "endLine": 915,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "date",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "unset_date": {
            "name": "unset_date",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return $this;\n  }",
            "startLine": 917,
            "endLine": 920,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "set_user": {
            "name": "set_user",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_user)\n  {\n      $this->id_user = $id_user;\n    }\n    return $this; \n  }",
            "startLine": 922,
            "endLine": 927,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_user",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "unset_user": {
            "name": "unset_user",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      $this->id_user = $user->get_id();\n    }\n    return $this;\n  }",
            "startLine": 929,
            "endLine": 934,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "insert": {
            "name": "insert",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $cfg)\n  {\n      if ( $this->db->insert('bbn_tasks', [\n        'title' => $cfg['title'],\n        'type' => $cfg['type'],\n        'priority' => $cfg['priority'] ?? 5,\n        'id_parent' => $cfg['id_parent'] ?? NULL,\n        'id_alias' => $cfg['id_alias'] ?? NULL,\n        'deadline' => $cfg['deadline'] ?? NULL,\n        'id_user' => $this->id_user ?: NULL,\n        'state' => $cfg['state'] ?? $this->id_state('opened'),\n        'creation_date' => $this->date ?: date('Y-m-d H:i:s')\n      ]) ){\n        $id = $this->db->last_id();\n        $this->add_log($id, 'insert');\n        $this->add_role($id, 'managers');\n        \/*\n        $subject = \"Nouveau bug post\u00e9 par {$this->user}\";\n        $text = \"<p>{$this->user} a post\u00e9 un nouveau bug<\/p>\".\n          \"<p><strong>$title<\/strong><\/p>\".\n          \"<p>\".nl2br($text).\"<\/p>\".\n          \"<p><em>Rendez-vous dans votre interface APST pour lui r\u00e9pondre<\/em><\/p>\";\n        $this->email($id, $subject, $text);\n        *\/\n        return $id;\n      }\n    }\n    return false;\n  }",
            "startLine": 936,
            "endLine": 964,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "cfg",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "update": {
            "name": "update",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $prop, $value)\n  {\n      $ok = false;\n      if ( $prop === 'deadline' ){\n        $prev = $this->db->select_one('bbn_tasks', 'deadline', ['id' => $id_task]);\n        if ( !$prev && $value ){\n          $this->add_log($id_task, 'deadline_insert', [$value]);\n          $ok = 1;\n        }\n        else if ( $prev && !$value ){\n          $this->add_log($id_task, 'deadline_delete', [$value]);\n          $ok = 1;\n        }\n        if ( $prev && $value && ($prev !== $value) ){\n          $this->add_log($id_task, 'deadline_update', [$prev, $value]);\n          $ok = 1;\n        }\n      }\n      else if ( $prop === 'price' ){\n        $prev = $this->db->select_one('bbn_tasks', 'price', ['id' => $id_task]);\n        if ( !$prev && $value ){\n          $this->add_log($id_task, 'price_insert', [$value]);\n          $ok = 1;\n        }\n        else if ( $prev && !$value ){\n          $this->add_log($id_task, 'price_delete', [$prev]);\n          $ok = 1;\n        }\n        if ( $prev && $value && ($prev !== $value) ){\n          $this->add_log($id_task, 'price_update', [$prev, $value]);\n          $ok = 1;\n        }\n      }\n      else if ( $prop === 'state' ){\n        $states = $this->states();\n        switch ( $value ){\n          case $states['closed']:\n            $ok = 1;\n            $this->add_log($id_task, 'task_close');\n            $this->stop_all_tracks($id_task);\n            break;\n          case $states['holding']:\n            $ok = 1;\n            $this->add_log($id_task, 'task_hold');\n            $this->stop_all_tracks($id_task);\n            break;\n          case $states['ongoing']:\n            $ok = 1;\n            $this->add_log($id_task, 'task_start');\n            break;\n          case $states['opened']:\n            $ok = 1;\n            $this->add_log($id_task, 'task_reopen');\n            break;\n          case $states['unapproved']:\n            $this->add_log($id_task, 'task_unapproved');\n            $this->stop_all_tracks($id_task);\n            $ok = 1;\n            break;\n        }\n      }\n      else if ( $prev = $this->db->select_one('bbn_tasks', $prop, ['id' => $id_task]) ){\n        $ok = 1;\n        $this->add_log($id_task, $prop.'_update', [$prev, $value]);\n      }\n      if ( $ok ){\n        return $this->db->update('bbn_tasks', [$prop => $value], ['id' => $id_task]);\n      }\n    }\n    return false;\n  }",
            "startLine": 966,
            "endLine": 1036,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 3,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "prop",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "value",
                    "position": 2,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "delete": {
            "name": "delete",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      ($info = $this->info($id)) &&\n      $this->db->update('bbn_tasks', ['active' => 0], ['id' => $id]) \n    ){\n      $this->add_log($id, 'delete');\n      \/* $subject = \"Suppression du bug $info[title]\";\n      $text = \"<p>{$this->user} a supprim\u00e9 le bug<br><strong>$info[title]<\/strong><\/p>\";\n      $this->email($id, $subject, $text); *\/\n      return $id;\n    }\n  }",
            "startLine": 1038,
            "endLine": 1049,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "approve": {
            "name": "approve",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      $this->exists($id) &&\n      ($info = $this->db->select('bbn_tasks', ['state', 'price'], ['id' => $id])) &&\n      ($unapproved = $this->id_state('unapproved')) &&\n      ($deciders = $this->get_deciders($id)) &&\n      in_array($this->id_user, $deciders)\n    ){\n      return ($info->state === $unapproved) && $this->add_log($id, 'price_approved', [$info->price]);\n    }\n    return false;\n  }",
            "startLine": 1051,
            "endLine": 1062,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "up": {
            "name": "up",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      return $this->update($id, $info['title'], $info['status'], $info['priority']-1, $info['deadline']);\n    }\n  }",
            "startLine": 1064,
            "endLine": 1068,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "down": {
            "name": "down",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      return $this->update($id, $info['title'], $info['status'], $info['priority']+1, $info['deadline']);\n    }\n  }",
            "startLine": 1070,
            "endLine": 1074,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "subscribe": {
            "name": "subscribe",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n  }",
            "startLine": 1076,
            "endLine": 1078,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "unsubscribe": {
            "name": "unsubscribe",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n  }",
            "startLine": 1080,
            "endLine": 1082,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "ping": {
            "name": "ping",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n  }",
            "startLine": 1084,
            "endLine": 1086,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "start_track": {
            "name": "start_track",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $id_user = false)\n  {\n      !$this->get_active_track($id_user) &&\n      ($ongoing = $this->id_state('ongoing')) &&\n      ($ongoing === $this->get_state($id_task)) &&\n      ($role = $this->has_role($id_task, $id_user ?: $this->id_user)) &&\n      (($role === 'managers') || ($role === 'workers'))\n    ){\n      return $this->db->insert('bbn_tasks_sessions', [\n        'id_task' => $id_task,\n        'id_user' => $id_user ?: $this->id_user,\n        'start' => date('Y-m-d H:i:s')\n      ]);\n    }\n    return false;\n  }",
            "startLine": 1088,
            "endLine": 1103,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "id_user",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "stop_track": {
            "name": "stop_track",
            "summary": "Stops a track.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task, $message = false, $id_user = false)\n  {\n    $now = time();\n    if (\n      ($active_track = $this->get_active_track($id_user)) &&\n      ($active_track['id_task'] === $id_task)\n    ){\n      $ok = true;\n      if (\n        !empty($message) &&\n        !($id_note = $this->comment($id_task, [\n          'title' => _('Report tracker').' '.date('d M Y H:i', strtotime($active_track['start'])).' - '.date('d M Y H:i', $now),\n          'text' => $message\n        ]))\n      ){\n        $ok = false;\n      }\n      if ( $ok ){\n        $ok = $this->db->update('bbn_tasks_sessions', [\n          'length' => $now - strtotime($active_track['start']),\n          'id_note' => $id_note ?: NULL\n        ], [\n          'id' => $active_track['id']\n        ]);\n      }\n    }\n    return (bool)$ok;\n  }",
            "startLine": 1113,
            "endLine": 1140,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 3,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "The message to attach to track (optional)"
                },
                {
                    "name": "message",
                    "position": 1,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": "",
                    "description": "user The track's user. If you give 'false', it will use the current user"
                },
                {
                    "name": "id_user",
                    "position": 2,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "stop_all_tracks": {
            "name": "stop_all_tracks",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n      UPDATE bbn_tasks_sessions\n      SET `length` = TO_SECONDS(NOW())-TO_SECONDS(start)\n      WHERE id_task = ?\n        AND `length` IS NULL\",\n      hex2bin($id)\n    );\n    return $this->db->get_one(\"\n      SELECT COUNT(*)\n      FROM bbn_tasks_sessions\n      WHERE id_task = ?\n        AND `length` IS NULL\",\n      hex2bin($id)\n    ) === 0;\n  }",
            "startLine": 1142,
            "endLine": 1157,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_active_track": {
            "name": "get_active_track",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_user = false)\n  {\n      SELECT *\n      FROM bbn_tasks_sessions\n      WHERE id_user = ?\n        AND length IS NULL\",\n      $id_user ? hex2bin($id_user) : hex2bin($this->id_user)\n    );\n  }",
            "startLine": 1159,
            "endLine": 1167,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_user",
                    "position": 0,
                    "type": "",
                    "required": false,
                    "has_default": true,
                    "default": false,
                    "default_name": ""
                }
            ]
        },
        "get_track": {
            "name": "get_track",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      SELECT *\n      FROM bbn_tasks_sessions\n      WHERE id_user = ?\n        AND id_task = ?\n        AND length IS NULL\",\n      hex2bin($this->id_user),\n      hex2bin($id_task)\n    );\n  }",
            "startLine": 1169,
            "endLine": 1179,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_tracks": {
            "name": "get_tracks",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      SELECT id_user, SUM(length) AS total_time\n      FROM bbn_tasks_sessions\n      WHERE id_task = ?\n      GROUP BY id_user\",\n      hex2bin($id_task)\n    );\n  }",
            "startLine": 1181,
            "endLine": 1189,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_tasks_tracks": {
            "name": "get_tasks_tracks",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_user)\n  {\n      ($manager = $this->id_role('managers')) &&\n      ($worker = $this->id_role('workers')) &&\n      ($ongoing = $this->id_state('ongoing'))\n    ){\n      return $this->db->get_rows(\"\n        SELECT bbn_tasks.*\n        FROM bbn_tasks\n        \tJOIN bbn_tasks_roles\n        \t\tON bbn_tasks_roles.id_task = bbn_tasks.id\n        \t\tAND bbn_tasks_roles.id_user = ?\n        \t\tAND (\n              bbn_tasks_roles.role = ?\n        \t\t\tOR bbn_tasks_roles.role = ?\n        \t\t)\n        WHERE bbn_tasks.active = 1\n          AND bbn_tasks.state = ?\n        GROUP BY bbn_tasks.id\",\n        hex2bin($id_user),\n        hex2bin($manager),\n        hex2bin($worker),\n        hex2bin($ongoing)\n      );\n    }\n  }",
            "startLine": 1191,
            "endLine": 1216,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_user",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_invoice": {
            "name": "get_invoice",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id_task)\n  {\n      return $this->db->rselect('bbn_invoices', [], ['id' => $id_invoice]);\n    }\n    return false;\n  }",
            "startLine": 1218,
            "endLine": 1223,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id_task",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "test": {
            "name": "test",
            "summary": "Checks whether the error property has been set (so an error happened).",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      return false;\n    }\n    return true;\n  }",
            "startLine": 45,
            "endLine": 50,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "test",
                "summary": "Checks whether the error property has been set (so an error happened).",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n      return false;\n    }\n    return true;\n  }",
                "startLine": 45,
                "endLine": 50,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "get_error": {
            "name": "get_error",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 72,
            "endLine": 74,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "get_error",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n  }",
                "startLine": 72,
                "endLine": 74,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "get_errors": {
            "name": "get_errors",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 76,
            "endLine": 78,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "get_errors",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n  }",
                "startLine": 76,
                "endLine": 78,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "log": {
            "name": "log",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n\t\t\t$ar = \\func_get_args();\n\t\t\t$cn = bbn\\str::encode_filename(str_replace('\\\\', '_', \\get_class($this)));\n\t\t\tforeach ( $ar as $a ){\n\t\t\t\tbbn\\x::log($a, $cn);\n\t\t\t}\n\t\t}\n  }",
            "startLine": 80,
            "endLine": 88,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "log",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n\t\t\t$ar = \\func_get_args();\n\t\t\t$cn = bbn\\str::encode_filename(str_replace('\\\\', '_', \\get_class($this)));\n\t\t\tforeach ( $ar as $a ){\n\t\t\t\tbbn\\x::log($a, $cn);\n\t\t\t}\n\t\t}\n  }",
                "startLine": 80,
                "endLine": 88,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "__call": {
            "name": "__call",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($name, $arguments)\n  {\n    $this->log([\"Wrong method used for the class $class: $name with the following arguments:\", $arguments]);\n    die(var_dump([\"Wrong method used for the class $class: $name with the following arguments:\", $arguments]));\n  }",
            "startLine": 95,
            "endLine": 99,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 2,
            "numberOfRequiredParameters": 2,
            "returns": null,
            "parent": {
                "name": "__call",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function($name, $arguments)\n  {\n    $this->log([\"Wrong method used for the class $class: $name with the following arguments:\", $arguments]);\n    die(var_dump([\"Wrong method used for the class $class: $name with the following arguments:\", $arguments]));\n  }",
                "startLine": 95,
                "endLine": 99,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 2,
                "numberOfRequiredParameters": 2,
                "returns": null,
                "parent": false,
                "arguments": [
                    {
                        "name": "name",
                        "position": 0,
                        "type": "",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    },
                    {
                        "name": "arguments",
                        "position": 1,
                        "type": "",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "name",
                    "position": 0,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                },
                {
                    "name": "arguments",
                    "position": 1,
                    "type": "",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "is_debug": {
            "name": "is_debug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 104,
            "endLine": 106,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": {
                "name": "is_debug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function()\n  {\n  }",
                "startLine": 104,
                "endLine": 106,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 0,
                "numberOfRequiredParameters": 0,
                "returns": null,
                "parent": false,
                "arguments": []
            },
            "arguments": []
        },
        "set_debug": {
            "name": "set_debug",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\models\\cls\\basic",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($debug)\n  {\n  }",
            "startLine": 112,
            "endLine": 114,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": {
                "name": "set_debug",
                "summary": "",
                "description": "",
                "description_parts": [],
                "file": "bbn\\models\\cls\\basic",
                "static": false,
                "visibility": "public",
                "final": false,
                "code": "function($debug)\n  {\n  }",
                "startLine": 112,
                "endLine": 114,
                "isDeprecated": false,
                "isGenerator": false,
                "isInternal": false,
                "isUserDefined": true,
                "isVariadic": false,
                "returnsReference": false,
                "numberOfParameters": 1,
                "numberOfRequiredParameters": 1,
                "returns": null,
                "parent": false,
                "arguments": [
                    {
                        "name": "debug",
                        "position": 0,
                        "type": "bool",
                        "required": true,
                        "has_default": false,
                        "default": "",
                        "default_name": ""
                    }
                ]
            },
            "arguments": [
                {
                    "name": "debug",
                    "position": 0,
                    "type": "bool",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_references": {
            "name": "get_references",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return [\n      'select' => $this->references_select,\n      'join' => $this->references_join\n    ];\n  }",
            "startLine": 52,
            "endLine": 58,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_option_root": {
            "name": "get_option_root",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::$option_root_id;\n  }",
            "startLine": 128,
            "endLine": 131,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_appui_root": {
            "name": "get_appui_root",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::$option_appui_id;\n  }",
            "startLine": 133,
            "endLine": 136,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_object": {
            "name": "get_options_object",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $o = bbn\\appui\\options::get_instance();\n    if (!$o) {\n      throw new \\Exception(_(\"Impossible to get the options object from class\").' '.__CLASS__);\n    }\n    return $o;\n  }",
            "startLine": 138,
            "endLine": 145,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "bbn\\appui\\options"
            ],
            "parent": false,
            "arguments": []
        },
        "get_option_id": {
            "name": "get_option_id",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 153,
            "endLine": 155,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_ids": {
            "name": "get_options_ids",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      return $a !== null;\n    }));\n  }",
            "startLine": 157,
            "endLine": 161,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_tree": {
            "name": "get_options_tree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::get_options_object()->full_tree(...self::_treat_args(func_get_args()))) ?\n      $tree['items'] : [];\n  }",
            "startLine": 163,
            "endLine": 167,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options": {
            "name": "get_options",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->full_options(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 169,
            "endLine": 172,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_option": {
            "name": "get_option",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n  }",
            "startLine": 174,
            "endLine": 176,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_text_value": {
            "name": "get_options_text_value",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n      self::get_options_object()->text_value_options($id): [];\n  }",
            "startLine": 178,
            "endLine": 181,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_appui_option_id": {
            "name": "get_appui_option_id",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->from_code(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 189,
            "endLine": 192,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string"
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_ids": {
            "name": "get_appui_options_ids",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::get_options_object()->get_codes(\n          ...self::_treat_args(func_get_args(), true)\n        ),\n        function($a){\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 194,
            "endLine": 206,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_tree": {
            "name": "get_appui_options_tree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::get_options_object()->full_tree(...self::_treat_args(func_get_args(), true)) ) ?\n      $tree['items'] : [];\n  }",
            "startLine": 208,
            "endLine": 212,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options": {
            "name": "get_appui_options",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->full_options(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 214,
            "endLine": 217,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_option": {
            "name": "get_appui_option",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->option(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 219,
            "endLine": 222,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_text_value": {
            "name": "get_appui_options_text_value",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\tasks",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::get_appui_option_id(...func_get_args())) ?\n    self::get_options_object()->text_value_options($id) : [];\n  }",
            "startLine": 224,
            "endLine": 228,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        }
    },
    "properties": null,
    "staticProperties": {
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null
    },
    "constants": null,
    "numMethods": 85,
    "numProperties": 0,
    "numConstants": 0,
    "numStaticProperties": 3,
    "interfaceNames": [],
    "isInterface": false,
    "traitNames": [
        "bbn\\models\\tts\\references",
        "bbn\\models\\tts\\optional"
    ],
    "traitAliases": [],
    "isTrait": false,
    "isAbstract": false,
    "isFinal": false,
    "modifiers": 0,
    "parentClass": "bbn\\models\\cls\\db",
    "isSubclassOf": false,
    "defaultProperties": {
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null,
        "columns": null,
        "template": false,
        "id_user": null,
        "is_dev": null,
        "user": null,
        "date": false,
        "db": null,
        "errors": [],
        "error": false,
        "debug": false,
        "log": [],
        "references": null,
        "references_select": "",
        "references_join": "",
        "options": null
    },
    "isIterable": false,
    "extensionName": false,
    "namespaceName": "bbn\\appui",
    "shortName": "tasks",
    "summary": ""
}