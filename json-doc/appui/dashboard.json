{
    "doc": {
        "description": "",
        "tags": []
    },
    "name": "bbn\\appui\\dashboard",
    "namespace": true,
    "traits": [
        "bbn\\models\\tts\\optional"
    ],
    "interfaces": [],
    "fileName": "\/home\/thomas\/domains\/apstapp.thomas.lan\/_appui\/vendor\/bbn\/bbn\/src\/bbn\/appui\/dashboard.php",
    "startLine": 10,
    "endLine": 308,
    "contentConstructor": {
        "file": "bbn\\appui\\dashboard",
        "returns": null
    },
    "methods": {
        "__construct": {
            "name": "__construct",
            "summary": "dashboard constructor.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($id)\n  {\n    $oid = $id;\n    $this->opt = bbn\\appui\\options::get_instance();\n    $this->user = bbn\\user::get_instance();\n    $this->perm = bbn\\user\\permissions::get_instance();\n    $this->pref = bbn\\user\\preferences::get_instance();\n    $ccfg = $this->pref->get_class_cfg();\n    $this->arch_opt = $this->opt->get_class_cfg()['arch']['options'];\n    $this->arch_pref = $ccfg['arch']['user_options'];\n    $this->arch_bits = $ccfg['arch']['user_options_bits'];\n    self::optional_init();\n    if (!bbn\\str::is_uid($id)) {\n      $id = $this->get_option_id($id);\n    }\n\n    if (bbn\\str::is_uid($id)) {\n      $this->dashboard = $id;\n    }\n    else {\n      throw new \\Exception(\"Unable to load the dashboard using identifier: $oid\");\n    }\n  }",
            "startLine": 143,
            "endLine": 165,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "id",
                    "position": 0,
                    "type": "string",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "add": {
            "name": "add",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $widget)\n  {\n    if (!empty($widget[$this->arch_opt['text']]) \n        && !empty($widget[$this->arch_opt['code']]) \n        && (!empty($widget['component']) || !empty($widget['itemComponent']))\n    ) {\n      $widget[$this->arch_opt['id_parent']] = $this->dashboard;\n      $widget[$this->arch_opt['id_alias']] = $widget[$this->arch_opt['id_alias']] ?? null;\n      $widget['closable'] = $widget['closable'] ?? false;\n      $widget['observe'] = $widget['observe'] ?? false;\n      $widget['limit'] = $widget['limit'] ?? 5;\n      $widget['buttonsRight'] = $widget['buttonsRight'] ?? [];\n      $widget['buttonsLeft'] = $widget['buttonsLeft'] ?? [];\n      $widget['options'] = $widget['options'] ?? new \\stdClass();\n      return $this->opt->add($widget);\n    }\n    return null;\n  }",
            "startLine": 167,
            "endLine": 184,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "widget",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "save": {
            "name": "save",
            "summary": "Saves the widget configuration",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $data)\n  {\n    if (!empty($data[$this->arch_pref['id']])) {\n      \/\/ Current option's id or preference's id\n      $id = $data[$this->arch_pref['id']];\n      \/\/ Normal widget\n      if ($cfg = $this->pref->get_by_option($id)) {\n        return $this->pref->set_by_option($id, \\bbn\\x::merge_arrays($cfg, $data[$this->arch_pref['cfg']]));\n      }\n      \/\/ User's personal widget\n      elseif ($old = $this->pref->get($id, false)) {\n        if (($cfg = json_decode($old[$this->arch_pref['cfg']], true)) && !empty($cfg['widget'])) {\n          $cfg['widget'] = \\bbn\\x::merge_arrays($cfg['widget'], $data[$this->arch_pref['cfg']]);  \n          return $this->pref->set_cfg($id, $cfg);  \n        }\n      }\n      else {\n        return $this->pref->add($id, $data[$this->arch_pref['cfg']]);  \n      }\n    }\n  }",
            "startLine": 191,
            "endLine": 211,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": null,
            "parent": false,
            "arguments": [
                {
                    "name": "data",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "sort": {
            "name": "sort",
            "summary": "Sorts the widgets' order",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $order)\n  {\n    if (!empty($order)) {\n      $changed = 0;\n      foreach ($order as $i => $k){\n        \/\/ Normal widget\n        if ($opt = $this->opt->option($k)) {\n          \/\/ Existing preference\n          if ($pref = $this->pref->get_by_option($k)) {\n            if ($pref[$this->arch_pref['num']] !== ($i + 1)) {\n              $pref[$this->arch_pref['num']] = $i + 1;\n              $this->pref->update($pref[$this->arch_pref['id']], $pref);\n              $changed++;\n            }\n          }\n          \/\/ Add new preference\n          elseif ($opt[$this->arch_opt['num']] !== ($i +1)) {\n            $this->pref->add($k, [$this->arch_pref['num'] => $i + 1]);\n            $changed++;\n          }\n        }\n        \/\/ User's personal widget\n        elseif (($pref = $this->pref->get($k)) \n            && ($pref[$this->arch_pref['num']] !== ($i + 1))\n        ) {\n          $pref[$this->arch_pref['num']] = $i + 1;\n          $this->pref->update($pref[$this->arch_pref['id']], $pref);\n          $changed++;\n        }\n      }\n      return $changed;\n    }\n    return null;\n  }",
            "startLine": 218,
            "endLine": 251,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "int",
                null
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "order",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "The ordered keys list"
                }
            ]
        },
        "get_widgets": {
            "name": "get_widgets",
            "summary": "Gets the widgets list of a dashboard and the order list.",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($url = '')\n  {\n    $widgets = $this->_get_widgets($url);\n    return [\n      'widgets' => $widgets,\n      'order' => $this->get_order($widgets)\n    ];\n  }",
            "startLine": 258,
            "endLine": 265,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "url",
                    "position": 0,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": "",
                    "default_name": "",
                    "description": "The url to set to the widget's property."
                }
            ]
        },
        "get_order": {
            "name": "get_order",
            "summary": "Gets an orderder array of the widgets' keys",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function(array $widgets)\n  {\n    $ret = [];\n    $toend = [];\n    if (bbn\\x::is_assoc($widgets)) {\n      $widgets = \\array_values($widgets);\n    }\n    foreach ($widgets as $widget){\n      if (bbn\\str::is_integer($widget[$this->arch_opt['num']]) \n          && !\\array_key_exists($widget[$this->arch_opt['num']], $ret) \n      ) {\n        $ret[$widget[$this->arch_opt['num']]] = $widget['key'];\n      }\n      else {\n        $toend[] = $widget['key'];\n      }\n    }\n    \\ksort($ret);\n    return \\array_values(\\array_merge($ret, $toend));\n  }",
            "startLine": 272,
            "endLine": 291,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 1,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "widgets",
                    "position": 0,
                    "type": "array",
                    "required": true,
                    "has_default": false,
                    "default": "",
                    "default_name": "",
                    "description": "The list of widgets"
                }
            ]
        },
        "get_widgets_code": {
            "name": "get_widgets_code",
            "summary": "Gets an associative array of widgets by code",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": false,
            "visibility": "public",
            "final": false,
            "code": "function($url = '')\n  {\n    $widgets = $this->_get_widgets($url, true);\n    $ret = [];\n    foreach ($widgets as $w){\n      $ret[$w[$this->arch_opt['code']]] = $w;\n    }\n    \\ksort($ret);\n    return $ret;\n  }",
            "startLine": 298,
            "endLine": 307,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 1,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": [
                {
                    "name": "url",
                    "position": 0,
                    "type": "string",
                    "required": false,
                    "has_default": true,
                    "default": "",
                    "default_name": ""
                }
            ]
        },
        "get_option_root": {
            "name": "get_option_root",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optional_init();\n    return self::$option_root_id;\n  }",
            "startLine": 145,
            "endLine": 149,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_appui_root": {
            "name": "get_appui_root",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    self::optional_init();\n    return self::$option_appui_id;\n  }",
            "startLine": 152,
            "endLine": 156,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_object": {
            "name": "get_options_object",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    $o = bbn\\appui\\options::get_instance();\n    if (!$o) {\n      throw new \\Exception(_(\"Impossible to get the options object from class\").' '.__CLASS__);\n    }\n\n    return $o;\n  }",
            "startLine": 159,
            "endLine": 167,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "bbn\\appui\\options"
            ],
            "parent": false,
            "arguments": []
        },
        "get_option_id": {
            "name": "get_option_id",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->from_code(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 176,
            "endLine": 179,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_ids": {
            "name": "get_options_ids",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::get_options_object()->get_codes(...self::_treat_args(func_get_args())), function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 182,
            "endLine": 191,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_tree": {
            "name": "get_options_tree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::get_options_object()->full_tree(...self::_treat_args(func_get_args()))) ? $tree['items'] : [];\n  }",
            "startLine": 194,
            "endLine": 197,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options": {
            "name": "get_options",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->full_options(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 200,
            "endLine": 203,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_option": {
            "name": "get_option",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->option(...self::_treat_args(func_get_args()));\n  }",
            "startLine": 206,
            "endLine": 209,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_options_text_value": {
            "name": "get_options_text_value",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::get_option_id(...func_get_args())) ? self::get_options_object()->text_value_options($id) : [];\n  }",
            "startLine": 212,
            "endLine": 215,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        },
        "get_appui_option_id": {
            "name": "get_appui_option_id",
            "summary": "Returns The option's ID of a category, i.e. direct children of option's root",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->from_code(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 224,
            "endLine": 227,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "string",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_ids": {
            "name": "get_appui_options_ids",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return array_flip(\n      array_filter(\n        self::get_options_object()->get_codes(\n          ...self::_treat_args(func_get_args(), true)\n        ),\n        function ($a) {\n          return $a !== null;\n        }\n      )\n    );\n  }",
            "startLine": 230,
            "endLine": 242,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_tree": {
            "name": "get_appui_options_tree",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($tree = self::get_options_object()->full_tree(...self::_treat_args(func_get_args(), true)) ) ? $tree['items'] : [];\n  }",
            "startLine": 245,
            "endLine": 248,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array"
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options": {
            "name": "get_appui_options",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->full_options(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 251,
            "endLine": 254,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_option": {
            "name": "get_appui_option",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return self::get_options_object()->option(...self::_treat_args(func_get_args(), true));\n  }",
            "startLine": 257,
            "endLine": 260,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": [
                "array",
                null
            ],
            "parent": false,
            "arguments": []
        },
        "get_appui_options_text_value": {
            "name": "get_appui_options_text_value",
            "summary": "",
            "description": "",
            "description_parts": [],
            "file": "bbn\\appui\\dashboard",
            "static": true,
            "visibility": "public",
            "final": false,
            "code": "function()\n  {\n    return ($id = self::get_appui_option_id(...func_get_args())) ? self::get_options_object()->text_value_options($id) : [];\n  }",
            "startLine": 263,
            "endLine": 266,
            "isDeprecated": false,
            "isGenerator": false,
            "isInternal": false,
            "isUserDefined": true,
            "isVariadic": false,
            "returnsReference": false,
            "numberOfParameters": 0,
            "numberOfRequiredParameters": 0,
            "returns": null,
            "parent": false,
            "arguments": []
        }
    },
    "properties": null,
    "staticProperties": {
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null
    },
    "constants": null,
    "numMethods": 22,
    "numProperties": 0,
    "numConstants": 0,
    "numStaticProperties": 3,
    "interfaceNames": [],
    "isInterface": false,
    "traitNames": [
        "bbn\\models\\tts\\optional"
    ],
    "traitAliases": [],
    "isTrait": false,
    "isAbstract": false,
    "isFinal": false,
    "modifiers": 0,
    "parentClass": null,
    "isSubclassOf": false,
    "defaultProperties": {
        "optional_is_init": false,
        "option_root_id": null,
        "option_appui_id": null,
        "opt": null,
        "user": null,
        "perm": null,
        "pref": null,
        "arch_opt": null,
        "arch_pref": null,
        "arch_bits": null,
        "dashboard": null,
        "options": null
    },
    "isIterable": false,
    "extensionName": false,
    "namespaceName": "bbn\\appui",
    "shortName": "dashboard",
    "summary": ""
}